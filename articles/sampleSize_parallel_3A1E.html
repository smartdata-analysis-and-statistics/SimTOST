<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bioequivalence Tests for Parallel Trial Designs: 3 Arms, 1 Endpoint • SimTOST</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Bioequivalence Tests for Parallel Trial Designs: 3 Arms, 1 Endpoint">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SimTOST</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intropkg.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/sampleSize_crossover.html">Bioequivalence Tests for 2x2 Cross-Over Trial Designs with Log-Normal Data</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_2A1E.html">Bioequivalence Tests for Parallel Trial Designs: 2 Arms, 1 Endpoint</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_2A3E.html">Bioequivalence Tests for Parallel Trial Designs: 2 Arms, 3 Endpoints</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_3A1E.html">Bioequivalence Tests for Parallel Trial Designs: 3 Arms, 1 Endpoint</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_3A3E.html">Bioequivalence Tests for Parallel Trial Designs: 3 Arms, 3 Endpoints</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel.html">Bioequivalence Tests for Parallel Trial Designs with Log-Normal Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/smartdata-analysis-and-statistics/SimTOST/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Bioequivalence Tests for Parallel Trial Designs:
3 Arms, 1 Endpoint</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/smartdata-analysis-and-statistics/SimTOST/blob/main/vignettes/sampleSize_parallel_3A1E.Rmd" class="external-link"><code>vignettes/sampleSize_parallel_3A1E.Rmd</code></a></small>
      <div class="hidden name"><code>sampleSize_parallel_3A1E.Rmd</code></div>

    </div>

    
    
<p>In the <code>SimTOST</code> R package, which is specifically designed
for sample size estimation for bioequivalence studies, hypothesis
testing is based on the Two One-Sided Tests (TOST) procedure. <span class="citation">(<a href="#ref-sozu_sample_2015">Sozu et al.
2015</a>)</span> In TOST, the equivalence test is framed as a comparison
between the the null hypothesis of ‘new product is worse by a clinically
relevant quantity’ and the alternative hypothesis of ‘difference between
products is too small to be clinically relevant’. This vignette focuses
on a parallel design, with 3 arms/treatments and 1 primary endpoint.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates advanced sample size calculation
techniques for parallel trial designs involving three arms and one
endpoint. Specifically, we calculate the required sample size to test
bioequivalence between a new treatment (SB2) and a reference product
(Remicade) administered in two different locations (“EU_Remicade” and
“USA_Remicade”). The endpoint of interest is the Area Under the Curve
(AUCinf), a commonly used pharmacokinetic measure.</p>
<p>In this example, we assume the endpoint follows a log-normal
distribution with equal variances across arms. The goal is to determine
the sample size needed to achieve 90% power while controlling the type I
error rate at 5%. The equivalence margin is defined as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>L</mi></msub><mo>=</mo><mn>80</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">E_L = 80\%</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>U</mi></msub><mo>=</mo><mn>125</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">E_U = 125\%</annotation></semantics></math>
of the reference mean on the original scale.</p>
<p>The methods presented in this vignette build on fundamental
bioequivalence testing concepts and extend them to multi-arm scenarios.
These examples provide practical insights for designing robust parallel
trials with complex equivalence testing requirements.</p>
<p>We assume that the primary endpoint, AUCinf, is on the original
scale, with the mean and standard deviation for each arm available. This
information is organized into a structured data table for further
analysis:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/smartdata-analysis-and-statistics/SimTOST" class="external-link">SimTOST</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span>arm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>,<span class="st">"RemEU"</span>,<span class="st">"RemUSA"</span><span class="op">)</span>,</span>
<span>                               mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">37162.0</span>, <span class="fl">37705.0</span>, <span class="fl">37702.8</span><span class="op">)</span>, </span>
<span>                               sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11113.62172</span>, <span class="fl">12332.41615</span>,<span class="fl">12113.72</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sample-size-calculation-for-aucinf-equivalence-to-eu-remicade">Sample Size Calculation for AUCinf: Equivalence to EU Remicade<a class="anchor" aria-label="anchor" href="#sample-size-calculation-for-aucinf-equivalence-to-eu-remicade"></a>
</h2>
<p>This example demonstrates how to calculate the required sample size
when testing the equivalence of SB2 to a reference drug, Remicade, as
administered in the EU. The goal is to determine the minimum number of
participants needed to ensure adequate power for the equivalence
test.</p>
<div class="section level3">
<h3 id="hypotheses">Hypotheses<a class="anchor" aria-label="anchor" href="#hypotheses"></a>
</h3>
<p>Null Hypothesis (No Equivalence):
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mfrac><msub><mi>μ</mi><mrow><mi>S</mi><mi>B</mi><mn>2</mn></mrow></msub><msub><mi>μ</mi><mrow><mi>R</mi><mi>e</mi><mi>m</mi><mi>E</mi><mi>U</mi></mrow></msub></mfrac><mo>≤</mo><msub><mi>E</mi><mi>L</mi></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>o</mi><mi>r</mi><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mfrac><msub><mi>μ</mi><mrow><mi>S</mi><mi>B</mi><mn>2</mn></mrow></msub><msub><mi>μ</mi><mrow><mi>R</mi><mi>e</mi><mi>m</mi><mi>E</mi><mi>U</mi></mrow></msub></mfrac><mo>≥</mo><msub><mi>E</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">H_0: \frac{\mu_{SB2}}{\mu_{RemEU}} \le E_L ~~ or~~ \frac{\mu_{SB2}}{\mu_{RemEU}} \ge E_U</annotation></semantics></math></p>
<p>Alternative Hypothesis (Equivalence):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><msub><mi>E</mi><mi>L</mi></msub><mo>&lt;</mo><mfrac><msub><mi>μ</mi><mrow><mi>S</mi><mi>B</mi><mn>2</mn></mrow></msub><msub><mi>μ</mi><mrow><mi>R</mi><mi>e</mi><mi>m</mi><mi>E</mi><mi>U</mi></mrow></msub></mfrac><mo>&lt;</mo><msub><mi>E</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">H_1: E_L&lt;\frac{\mu_{SB2}}{\mu_{RemEU}} &lt; E_U</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>L</mi></msub><annotation encoding="application/x-tex">E_L</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>E</mi><mi>U</mi></msub><annotation encoding="application/x-tex">E_U</annotation></semantics></math>
represent the lower and upper equivalence margins, respectively.</p>
</div>
<div class="section level3">
<h3 id="preparing-the-function-arguments">Preparing the function arguments<a class="anchor" aria-label="anchor" href="#preparing-the-function-arguments"></a>
</h3>
<p>To proceed with the sample size calculation, we first need to
organize the mean and standard deviation values of each arm (SB2, EU
Remicade, USA Remicade) as list objects.</p>
<p>Since this example focuses on a single endpoint, the mean list
(<code>mu_list</code>) contains three scalar elements corresponding to
each arm, and the standard deviation list (<code>sigma_list</code>)
contains three 1x1 matrix elements.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span>  <span class="co"># Organize mean values into a list</span></span>
<span><span class="va">sigma_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">sd</span><span class="op">)</span>  <span class="co"># Organize standard deviation values into a list</span></span></code></pre></div>
<p>Next, we define the comparison parameters, including the lower
(<code>lequi.tol</code>) and upper (<code>uequi.tol</code>) equivalence
boundaries, as well as the list of comparators. Since we are only
comparing two arms (SB2 and EU Remicade), the list of comparators
contains a single element specifying these two arms:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_comparator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Comparison"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>,<span class="st">"RemEU"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">list_lequi.tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Comparison"</span> <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="va">list_uequi.tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Comparison"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="computing-sample-size">Computing Sample Size<a class="anchor" aria-label="anchor" href="#computing-sample-size"></a>
</h3>
<p>Finally, we use the <a href="../reference/sampleSize.html">sampleSize()</a> function to
calculate the required sample size based on stochastic simulations of
the trial. The function accepts several parameters, such as the desired
power, confidence level, and design specifications. By default, it
assumes:</p>
<ul>
<li>A parallel design,</li>
<li>A test based on the ratio of means (ROM),</li>
<li>Equal variances across arms,</li>
<li>A lognormal distribution for the endpoint.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AUCinf_1comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.9</span>,                  <span class="co"># Target power</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,                 <span class="co"># Confidence level</span></span>
<span>  arm_names <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">arm</span>,         <span class="co"># Names of trial arms</span></span>
<span>  list_comparator <span class="op">=</span> <span class="va">list_comparator</span>,  <span class="co"># Comparator configuration</span></span>
<span>  mu_list <span class="op">=</span> <span class="va">mu_list</span>,            <span class="co"># Mean values</span></span>
<span>  sigma_list <span class="op">=</span> <span class="va">sigma_list</span>,      <span class="co"># Standard deviation values</span></span>
<span>  list_lequi.tol <span class="op">=</span> <span class="va">list_lequi.tol</span>,   <span class="co"># Lower equivalence boundary</span></span>
<span>  list_uequi.tol <span class="op">=</span> <span class="va">list_uequi.tol</span>,   <span class="co"># Upper equivalence boundary</span></span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,                   <span class="co"># Number of cores for computation</span></span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span>                   <span class="co"># Number of stochastic simulations</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in derive_TAR(TAR = TAR, n_arms = n): Warning: TAR is missing or NULL.</span></span>
<span><span class="co">#&gt; Setting TAR to a default vector of ones.</span></span>
<span></span>
<span><span class="va">AUCinf_1comp</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. RemEU </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: y1 </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter     Value</span></span>
<span><span class="co">#&gt;          Total Sample Size        84</span></span>
<span><span class="co">#&gt;             Achieved Power      90.3</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 88.3 - 92</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>The required sample size for this scenario is 84, or 42 for each
arm.</p>
</div>
</div>
<div class="section level2">
<h2 id="sample-size-calculation-for-aucinf-equivalence-to-us-remicade-and-eu-remicade">Sample Size Calculation for AUCinf: Equivalence to US Remicade and
EU Remicade<a class="anchor" aria-label="anchor" href="#sample-size-calculation-for-aucinf-equivalence-to-us-remicade-and-eu-remicade"></a>
</h2>
<p>In this section, we calculate the sample size required to demonstrate
equivalence with both the European reference product (RemEU) and the US
reference product (RemUS). This scenario involves a more complex
comparison, as we must simultaneously establish equivalence with two
distinct reference arms.</p>
<div class="section level3">
<h3 id="hypotheses-1">Hypotheses<a class="anchor" aria-label="anchor" href="#hypotheses-1"></a>
</h3>
<p>Null Hypothesis (No Equivalence):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mfrac><msub><mi>μ</mi><mrow><mi>S</mi><mi>B</mi><mn>2</mn></mrow></msub><msub><mi>μ</mi><mrow><mi>R</mi><mi>e</mi><mi>m</mi><mi>E</mi><mi>U</mi></mrow></msub></mfrac><mo>≤</mo><msub><mi>E</mi><mi>L</mi></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>o</mi><mi>r</mi><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mfrac><msub><mi>μ</mi><mrow><mi>S</mi><mi>B</mi><mn>2</mn></mrow></msub><msub><mi>μ</mi><mrow><mi>R</mi><mi>e</mi><mi>m</mi><mi>E</mi><mi>U</mi></mrow></msub></mfrac><mo>≥</mo><msub><mi>E</mi><mi>U</mi></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>o</mi><mi>r</mi><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mfrac><msub><mi>μ</mi><mrow><mi>S</mi><mi>B</mi><mn>2</mn></mrow></msub><msub><mi>μ</mi><mrow><mi>R</mi><mi>e</mi><mi>m</mi><mi>U</mi><mi>S</mi><mi>A</mi></mrow></msub></mfrac><mo>≤</mo><msub><mi>E</mi><mi>L</mi></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>o</mi><mi>r</mi><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mfrac><msub><mi>μ</mi><mrow><mi>S</mi><mi>B</mi><mn>2</mn></mrow></msub><msub><mi>μ</mi><mrow><mi>R</mi><mi>e</mi><mi>m</mi><mi>U</mi><mi>S</mi><mi>A</mi></mrow></msub></mfrac><mo>≥</mo><msub><mi>E</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">H_0: \frac{\mu_{SB2}}{\mu_{RemEU}} \le E_L ~~ or~~ \frac{\mu_{SB2}}{\mu_{RemEU}} \ge E_U~~ or~~ \frac{\mu_{SB2}}{\mu_{RemUSA}} \le E_L ~~ or~~ \frac{\mu_{SB2}}{\mu_{RemUSA}} \ge E_U</annotation></semantics></math></p>
<p>Alternative Hypothesis (Equivalence):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><msub><mi>E</mi><mi>L</mi></msub><mo>&lt;</mo><mfrac><msub><mi>μ</mi><mrow><mi>S</mi><mi>B</mi><mn>2</mn></mrow></msub><msub><mi>μ</mi><mrow><mi>R</mi><mi>e</mi><mi>m</mi><mi>E</mi><mi>U</mi></mrow></msub></mfrac><mo>&lt;</mo><msub><mi>E</mi><mi>U</mi></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>a</mi><mi>n</mi><mi>d</mi><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msub><mi>E</mi><mi>L</mi></msub><mo>&lt;</mo><mfrac><msub><mi>μ</mi><mrow><mi>S</mi><mi>B</mi><mn>2</mn></mrow></msub><msub><mi>μ</mi><mrow><mi>R</mi><mi>e</mi><mi>m</mi><mi>U</mi><mi>S</mi><mi>A</mi></mrow></msub></mfrac><mo>&lt;</mo><msub><mi>E</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">H_1: E_L&lt;\frac{\mu_{SB2}}{\mu_{RemEU}} &lt; E_U~~ and~~E_L&lt;\frac{\mu_{SB2}}{\mu_{RemUSA}} &lt; E_U</annotation></semantics></math><strong>Key Considerations</strong></p>
<ul>
<li>The function <a href="../reference/sampleSize.html">sampleSize()</a>
adjusts the alpha level for multiple comparisons within a single
comparator (e.g., comparisons involving only RemEU or RemUSA).</li>
<li>The function does not yet account for alpha adjustments between
comparators when simultaneously comparing SB2 with both reference
products (RemEU and RemUSA). Thus, the null hypothesis is rejected if
any ROM falls outside the equivalence boundaries. Future package updates
will address this limitation and include proper alpha adjustments for
comparisons between comparators.</li>
</ul>
</div>
<div class="section level3">
<h3 id="implementation-details">Implementation Details<a class="anchor" aria-label="anchor" href="#implementation-details"></a>
</h3>
<p>Implementation of this scenario is similar to the initial example, in
which the <code>list_comparator</code> is modified to include multiple
comparators. The list contains two elements specifying the simultaneous
comparison between SB2 vs. RemEU and SB2 vs. RemUSA. This approach
ensures that the equivalence assessment accounts for both reference
products.</p>
<p>Additionally, we must specify equivalence boundaries for each
comparison individually. These boundaries define the acceptable range
for equivalence and are provided separately for each comparator.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_comparator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>, <span class="st">"RemEU"</span><span class="op">)</span>,</span>
<span>                        <span class="st">"FDA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>, <span class="st">"RemUSA"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">list_lequi.tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fl">0.8</span>, <span class="st">"FDA"</span> <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>     <span class="co"># Lower equivalence boundary</span></span>
<span><span class="va">list_uequi.tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">0.8</span>, <span class="st">"FDA"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">0.8</span><span class="op">)</span> <span class="co"># Upper equivalence boundary</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="computing-sample-size-1">Computing Sample Size<a class="anchor" aria-label="anchor" href="#computing-sample-size-1"></a>
</h3>
<p>We then pass these values into the <a href="../reference/sampleSize.html">sampleSize()</a> function to
calculate the required sample size for multiple comparisons.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">AUCinf_2comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.9</span>,                  <span class="co"># Target power</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,                 <span class="co"># Confidence level</span></span>
<span>  arm_names <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">arm</span>,         <span class="co"># Names of trial arms</span></span>
<span>  list_comparator <span class="op">=</span> <span class="va">list_comparator</span>,  <span class="co"># Comparator configuration</span></span>
<span>  mu_list <span class="op">=</span> <span class="va">mu_list</span>,            <span class="co"># Mean values</span></span>
<span>  sigma_list <span class="op">=</span> <span class="va">sigma_list</span>,      <span class="co"># Standard deviation values</span></span>
<span>  list_lequi.tol <span class="op">=</span> <span class="va">list_lequi.tol</span>,   <span class="co"># Lower equivalence boundary</span></span>
<span>  list_uequi.tol <span class="op">=</span> <span class="va">list_uequi.tol</span>,   <span class="co"># Upper equivalence boundary</span></span>
<span>  ncores <span class="op">=</span> <span class="fl">1</span>,                   <span class="co"># Number of cores for computation</span></span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span>                   <span class="co"># Number of stochastic simulations</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in derive_TAR(TAR = TAR, n_arms = n): Warning: TAR is missing or NULL.</span></span>
<span><span class="co">#&gt; Setting TAR to a default vector of ones.</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. RemEU </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: y1 </span></span>
<span><span class="co">#&gt;    SB2 vs. RemUSA </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: y1 </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter     Value</span></span>
<span><span class="co">#&gt;          Total Sample Size       150</span></span>
<span><span class="co">#&gt;             Achieved Power        91</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 89 - 92.7</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="results-and-interpretation">Results and Interpretation<a class="anchor" aria-label="anchor" href="#results-and-interpretation"></a>
</h3>
<p>The required total sample size for this scenario is 150. Notably, an
additional 8 patients per arm are required to achieve equivalence with
both reference products (RemEU and RemUSA), compared to the scenario
where equivalence is required with only one reference arm (42).</p>
<p>This example demonstrates the added complexity and sample size
requirements when multiple comparators are involved in an equivalence
trial.</p>
<p>The SimTOST package includes the <a href="../reference/plot.simss.html">plot()</a> function, which is
designed to permit visualization of the relationship between sample size
(x-axis) and achieved power (y-axis) for all combinations of endpoints
and comparators. In this example, we use the <a href="../reference/plot.simss.html">plot()</a> function to generate a
plot for the <code>AUCinf_2comp</code> object.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">AUCinf_2comp</span><span class="op">)</span></span></code></pre></div>
<p><img src="sampleSize_parallel_3A1E_files/figure-html/unnamed-chunk-7-1.png" width="95%"></p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-sozu_sample_2015" class="csl-entry">
Sozu, Takashi, Tomoyuki Sugimoto, Toshimitsu Hamasaki, and Scott R.
Evans. 2015. <em>Sample <span>Size Determination</span> in
<span>Clinical Trials</span> with <span>Multiple Endpoints</span></em>.
<span>SpringerBriefs</span> in <span>Statistics</span>. Cham: Springer
International Publishing. <a href="https://doi.org/10.1007/978-3-319-22005-5" class="external-link">https://doi.org/10.1007/978-3-319-22005-5</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Thomas Debray, Johanna Muñoz, Dewi Amaliah, Biogen Inc.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
