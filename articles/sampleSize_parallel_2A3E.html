<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bioequivalence Tests for Parallel Trial Designs: 2 Arms, 3 Endpoints • SimTOST</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Bioequivalence Tests for Parallel Trial Designs: 2 Arms, 3 Endpoints">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SimTOST</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intropkg.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/sampleSize_crossover.html">Bioequivalence Tests for 2x2 Cross-Over Trial Designs with Log-Normal Data</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_2A1E.html">Bioequivalence Tests for Parallel Trial Designs: 2 Arms, 1 Endpoint</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_2A3E.html">Bioequivalence Tests for Parallel Trial Designs: 2 Arms, 3 Endpoints</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_3A1E.html">Bioequivalence Tests for Parallel Trial Designs: 3 Arms, 1 Endpoint</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_3A3E.html">Bioequivalence Tests for Parallel Trial Designs: 3 Arms, 3 Endpoints</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel.html">Bioequivalence Tests for Parallel Trial Designs with Log-Normal Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><script src="sampleSize_parallel_2A3E_files/kePrint-0.0.1/kePrint.js"></script><link href="sampleSize_parallel_2A3E_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Bioequivalence Tests for Parallel Trial Designs:
2 Arms, 3 Endpoints</h1>
            
      

      <div class="hidden name"><code>sampleSize_parallel_2A3E.Rmd</code></div>

    </div>

    
    
<p>In the <code>SimTOST</code> R package, which is specifically designed
for sample size estimation for bioequivalence studies, hypothesis
testing is based on the Two One-Sided Tests (TOST) procedure. <span class="citation">(<a href="#ref-sozu_sample_2015">Sozu et al.
2015</a>)</span> In TOST, the equivalence test is framed as a comparison
between the the null hypothesis of ‘new product is worse by a clinically
relevant quantity’ and the alternative hypothesis of ‘difference between
products is too small to be clinically relevant’. This vignette focuses
on a parallel design, with 2 arms/treatments and 3 primary
endpoints.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In many studies, the aim is to evaluate equivalence across multiple
primary endpoints. The European Medicines Agency (EMA) recommends
demonstrating bioequivalence for both <strong>Area Under the
Curve</strong> (AUC) and <strong>maximum concentration</strong> (Cmax)
when assessing pharmacokinetic properties. This vignette presents
advanced techniques for calculating sample size in parallel trial
designs involving three treatment arms and two endpoints.</p>
<p>As an illustrative example, we consider published data from the
phase-1 trial <a href="https://clinicaltrials.gov/study/NCT01922336#study-overview" class="external-link">NCT01922336</a>.
This trial measured the pharmacokinetics (PK) of SB2 compared to its
EU-sourced reference product (EU_Remicade). The following PK measures
were reported following a single dose of SB2 or its EU reference product
Remicade <span class="citation">(<a href="#ref-shin_randomized_2015">Shin et al. 2015</a>)</span>:</p>
<table class="table table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
Primary PK measures between test and reference product. Data represent
arithmetic mean +- standard deviation.
</caption>
<thead><tr>
<th style="text-align:left;">
PK measure
</th>
<th style="text-align:left;">
SB2
</th>
<th style="text-align:left;">
Remicade (EU)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
AUCinf
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>g*h/mL)
</td>
<td style="text-align:left;">
38,703
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
11,114
</td>
<td style="text-align:left;">
39,360
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
12,332
</td>
</tr>
<tr>
<td style="text-align:left;">
AUClast
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>g*h/mL)
</td>
<td style="text-align:left;">
36,862
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
9133
</td>
<td style="text-align:left;">
37,022
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
9398
</td>
</tr>
<tr>
<td style="text-align:left;">
Cmax
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>g/mL)
</td>
<td style="text-align:left;">
127.0
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
16.9
</td>
<td style="text-align:left;">
126.2
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
17.9
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="testing-multiple-co-primary-endpoints">Testing multiple co-primary endpoints<a class="anchor" aria-label="anchor" href="#testing-multiple-co-primary-endpoints"></a>
</h2>
<p>The following sections describe strategies for determining the sample
size required for a parallel-group trial aimed at establishing
equivalence across three co-primary endpoints. The Ratio of Means (ROM)
approach will be used to assess equivalence.</p>
<p>A critical step in this process is defining the lower and upper
equivalence boundaries for each endpoint. These boundaries set the
acceptable ROM range within which equivalence is established. For
simplicity, a consistent equivalence range of 0.8 to 1.25 is applied to
all endpoints.</p>
<div class="section level3">
<h3 id="independent-testing-of-co-primary-endpoints">Independent Testing of Co-Primary Endpoints<a class="anchor" aria-label="anchor" href="#independent-testing-of-co-primary-endpoints"></a>
</h3>
<p>A conservative approach to sample size calculation involves testing
each pharmacokinetic (PK) measure independently. This approach assumes
that endpoints are uncorrelated and that equivalence is to be
demonstrated for each endpoint separately. Consequently, the overall
sample size required for the trial is the sum of the sample sizes
calculated for each PK measure separately.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://smartdata-analysis-and-statistics.github.io/SimTOST/" class="external-link">SimTOST</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sample size calculation for AUCinf</span></span>
<span><span class="op">(</span><span class="va">sim_AUCinf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.9</span>,                                <span class="co"># Target power</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,                               <span class="co"># Significance level</span></span>
<span>  arm_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>, <span class="st">"EU_Remicade"</span><span class="op">)</span>,        <span class="co"># Names of trial arms</span></span>
<span>  list_comparator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>,<span class="st">"EU_Remicade"</span><span class="op">)</span><span class="op">)</span>,   <span class="co"># Comparator configuration</span></span>
<span>  mu_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"SB2"</span> <span class="op">=</span> <span class="fl">38703</span>, <span class="st">"EU_Remicade"</span> <span class="op">=</span> <span class="fl">39360</span><span class="op">)</span>,     <span class="co"># Mean values</span></span>
<span>  sigma_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"SB2"</span> <span class="op">=</span> <span class="fl">11114</span>, <span class="st">"EU_Remicade"</span> <span class="op">=</span> <span class="fl">12332</span><span class="op">)</span>,  <span class="co"># Standard deviation values</span></span>
<span>  list_lequi.tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span>,        <span class="co"># Lower equivalence margin</span></span>
<span>  list_uequi.tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span>,        <span class="co"># Upper equivalence margin</span></span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span>                                 <span class="co"># Number of stochastic simulations</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. EU_Remicade </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: y1 </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter       Value</span></span>
<span><span class="co">#&gt;          Total Sample Size          78</span></span>
<span><span class="co">#&gt;             Achieved Power        90.5</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 88.5 - 92.2</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span></span>
<span><span class="co"># Sample size calculation for AUClast</span></span>
<span><span class="op">(</span><span class="va">sim_AUClast</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.9</span>,                                <span class="co"># Target power</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,                               <span class="co"># Significance level</span></span>
<span>  arm_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>, <span class="st">"EU_Remicade"</span><span class="op">)</span>,        <span class="co"># Names of trial arms</span></span>
<span>  list_comparator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>, <span class="st">"EU_Remicade"</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># Comparator configuration</span></span>
<span>  mu_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"SB2"</span> <span class="op">=</span> <span class="fl">36862</span>, <span class="st">"EU_Remicade"</span> <span class="op">=</span> <span class="fl">37022</span><span class="op">)</span>,     <span class="co"># Mean values</span></span>
<span>  sigma_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"SB2"</span> <span class="op">=</span> <span class="fl">9133</span>, <span class="st">"EU_Remicade"</span> <span class="op">=</span> <span class="fl">9398</span><span class="op">)</span>,    <span class="co"># Standard deviation values</span></span>
<span>  list_lequi.tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span>,        <span class="co"># Lower equivalence margin</span></span>
<span>  list_uequi.tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span>,        <span class="co"># Upper equivalence margin</span></span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span>                                 <span class="co"># Number of stochastic simulations</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. EU_Remicade </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: y1 </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter       Value</span></span>
<span><span class="co">#&gt;          Total Sample Size          54</span></span>
<span><span class="co">#&gt;             Achieved Power        90.4</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 88.4 - 92.1</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span></span>
<span></span>
<span><span class="co"># Sample size calculation for Cmax</span></span>
<span><span class="op">(</span><span class="va">sim_Cmax</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.9</span>,                                <span class="co"># Target power</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,                               <span class="co"># Significance level</span></span>
<span>  arm_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>, <span class="st">"EU_Remicade"</span><span class="op">)</span>,        <span class="co"># Names of trial arms</span></span>
<span>  list_comparator <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>, <span class="st">"EU_Remicade"</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># Comparator configuration</span></span>
<span>  mu_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"SB2"</span> <span class="op">=</span> <span class="fl">127.0</span>, <span class="st">"EU_Remicade"</span> <span class="op">=</span> <span class="fl">126.2</span><span class="op">)</span>,     <span class="co"># Mean values</span></span>
<span>  sigma_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"SB2"</span> <span class="op">=</span> <span class="fl">16.9</span>, <span class="st">"EU_Remicade"</span> <span class="op">=</span> <span class="fl">17.9</span><span class="op">)</span>,    <span class="co"># Standard deviation values</span></span>
<span>  list_lequi.tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fl">0.80</span><span class="op">)</span>,        <span class="co"># Lower equivalence margin</span></span>
<span>  list_uequi.tol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span>,        <span class="co"># Upper equivalence margin</span></span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span>                                 <span class="co"># Number of stochastic simulations</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. EU_Remicade </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: y1 </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter       Value</span></span>
<span><span class="co">#&gt;          Total Sample Size          18</span></span>
<span><span class="co">#&gt;             Achieved Power        91.2</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 89.2 - 92.8</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>When testing each PK measure independently, the total sample size is
78 for AUCinf, 54 for AUClast, and 18 for Cmax. This means that we would
have to enroll 78 + 54 + 18 = 150 patients in order to reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>.
Note that the significance level of this combined test is then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mn>0.05</mn><mn>3</mn></msup><annotation encoding="application/x-tex">0.05^3</annotation></semantics></math>.
For context, the original trial was a randomized, single-blind,
three-arm, parallel-group study conducted in 159 healthy subjects,
slightly more than the 150 patients estimated to be necessary.</p>
</div>
<div class="section level3">
<h3 id="simultaneous-testing-of-independent-co-primary-endpoints">Simultaneous Testing of Independent Co-Primary Endpoints<a class="anchor" aria-label="anchor" href="#simultaneous-testing-of-independent-co-primary-endpoints"></a>
</h3>
<p>This approach focuses on simultaneous testing of PK measures while
assuming independence between endpoints. Unlike the previous approach,
which tested each PK measure independently, this approach integrates
comparisons across multiple endpoints while directly controlling the
overall Type I error rate at a pre-specified level.</p>
<p>The arithmetic means and standard deviations for each endpoint and
treatment arm are defined as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  SB2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">38703</span>, AUClast <span class="op">=</span> <span class="fl">36862</span>, Cmax <span class="op">=</span> <span class="fl">127.0</span><span class="op">)</span>,</span>
<span>  EUREF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">39360</span>, AUClast <span class="op">=</span> <span class="fl">37022</span>, Cmax <span class="op">=</span> <span class="fl">126.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sigma_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  SB2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">11114</span>, AUClast <span class="op">=</span> <span class="fl">9133</span>, Cmax <span class="op">=</span> <span class="fl">16.9</span><span class="op">)</span>,</span>
<span>  EUREF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">12332</span>, AUClast <span class="op">=</span> <span class="fl">9398</span>, Cmax <span class="op">=</span> <span class="fl">17.9</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Subsequently, we define the equivalence boundaries:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_comparator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>, <span class="st">"EUREF"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">list_lequi.tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">0.8</span>, AUClast <span class="op">=</span> <span class="fl">0.8</span>, Cmax <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">list_uequi.tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">1.25</span>, AUClast <span class="op">=</span> <span class="fl">1.25</span>, Cmax <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Sample size calculation can then be implemented as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">N_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">0.9</span>, <span class="co"># target power</span></span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                    mu_list <span class="op">=</span> <span class="va">mu_list</span>,</span>
<span>                    sigma_list <span class="op">=</span> <span class="va">sigma_list</span>,</span>
<span>                    list_comparator <span class="op">=</span> <span class="va">list_comparator</span>,</span>
<span>                    list_lequi.tol <span class="op">=</span> <span class="va">list_lequi.tol</span>,</span>
<span>                    list_uequi.tol <span class="op">=</span> <span class="va">list_uequi.tol</span>,</span>
<span>                    dtype <span class="op">=</span> <span class="st">"parallel"</span>,</span>
<span>                    ctype <span class="op">=</span> <span class="st">"ROM"</span>,</span>
<span>                    vareq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    lognorm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                    nsim <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                    seed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. EUREF </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span><span class="co">#&gt;       (multiple co-primary endpoints, m =  3 )</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter       Value</span></span>
<span><span class="co">#&gt;          Total Sample Size          84</span></span>
<span><span class="co">#&gt;             Achieved Power          90</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 87.9 - 91.8</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>We can inspect the sample size requirements in more detail as
follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N_ss</span><span class="op">$</span><span class="va">response</span></span>
<span><span class="co">#&gt;    n_iter n_drop n_SB2 n_EUREF n_total power power_LCI power_UCI</span></span>
<span><span class="co">#&gt;     &lt;num&gt;  &lt;num&gt; &lt;num&gt;   &lt;num&gt;   &lt;num&gt; &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:     42      0    42      42      84   0.9 0.8793091 0.9175476</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simultaneous-testing-of-correlated-co-primary-endpoints">Simultaneous Testing of Correlated Co-Primary Endpoints<a class="anchor" aria-label="anchor" href="#simultaneous-testing-of-correlated-co-primary-endpoints"></a>
</h3>
<p>Incorporating the correlations between endpoints in sample size
calculations for continuous-valued co-primary endpoints offers
significant advantages <span class="citation">(<a href="#ref-sozu_sample_2015">Sozu et al. 2015</a>)</span>. Adding more
endpoints typically reduces power if such correlations are not accounted
for. However, by including positive correlations in the calculations,
power can be increased, and the required sample sizes may consequently
be reduced.</p>
<p>For this scenario, we proceed with the same values used previously
but now assume that a correlation exists between endpoints.
Specifically, we set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mn>0.6</mn></mrow><annotation encoding="application/x-tex">\rho = 0.6</annotation></semantics></math>,
assuming a common correlation across all endpoints.</p>
<p>If correlations differ between endpoints, they can be specified
individually using a correlation matrix (<code>cor_mat</code>), allowing
for greater flexibility in the analysis.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">N_mult_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">0.9</span>, <span class="co"># target power</span></span>
<span>                           alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>                           mu_list <span class="op">=</span> <span class="va">mu_list</span>,</span>
<span>                           sigma_list <span class="op">=</span> <span class="va">sigma_list</span>,</span>
<span>                           list_comparator <span class="op">=</span> <span class="va">list_comparator</span>,</span>
<span>                           list_lequi.tol <span class="op">=</span> <span class="va">list_lequi.tol</span>,</span>
<span>                           list_uequi.tol <span class="op">=</span> <span class="va">list_uequi.tol</span>,</span>
<span>                           rho <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>                           dtype <span class="op">=</span> <span class="st">"parallel"</span>,</span>
<span>                           ctype <span class="op">=</span> <span class="st">"ROM"</span>,</span>
<span>                           vareq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           lognorm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                           nsim <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                           seed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. EUREF </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span><span class="co">#&gt;       (multiple co-primary endpoints, m =  3 )</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter       Value</span></span>
<span><span class="co">#&gt;          Total Sample Size          82</span></span>
<span><span class="co">#&gt;             Achieved Power        90.4</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 88.4 - 92.1</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>The required total sample size for this example is 82. This is 2
fewer patients than the scenario in which endpoints are assumed to be
uncorrelated.</p>
</div>
</div>
<div class="section level2">
<h2 id="multiple-primary">Testing multiple primary endpoints<a class="anchor" aria-label="anchor" href="#multiple-primary"></a>
</h2>
<div class="section level3">
<h3 id="simultaneous-testing-of-primary-endpoints">Simultaneous Testing of Primary Endpoints<a class="anchor" aria-label="anchor" href="#simultaneous-testing-of-primary-endpoints"></a>
</h3>
<p>Imagine that we are interested in demonstrating equivalence for at
least
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
primary endpoints. Unlike the previous scenarios, in which equivalence
was required for all endpoints, this scenario requires an adjustment for
multiplicity to control the family-wise error rate. For example, when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k=1</annotation></semantics></math>,
we can use the Bonferroni correction:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">N_mp_bon</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.9</span>,               <span class="co"># Target power</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,              <span class="co"># Significance level</span></span>
<span>  mu_list <span class="op">=</span> <span class="va">mu_list</span>,         <span class="co"># List of means</span></span>
<span>  sigma_list <span class="op">=</span> <span class="va">sigma_list</span>,   <span class="co"># List of standard deviations</span></span>
<span>  list_comparator <span class="op">=</span> <span class="va">list_comparator</span>,  <span class="co"># Comparator configurations</span></span>
<span>  list_lequi.tol <span class="op">=</span> <span class="va">list_lequi.tol</span>,    <span class="co"># Lower equivalence boundaries</span></span>
<span>  list_uequi.tol <span class="op">=</span> <span class="va">list_uequi.tol</span>,    <span class="co"># Upper equivalence boundaries</span></span>
<span>  rho <span class="op">=</span> <span class="fl">0.6</span>,                 <span class="co"># Correlation between endpoints</span></span>
<span>  dtype <span class="op">=</span> <span class="st">"parallel"</span>,        <span class="co"># Trial design type</span></span>
<span>  ctype <span class="op">=</span> <span class="st">"ROM"</span>,             <span class="co"># Test type (Ratio of Means)</span></span>
<span>  vareq <span class="op">=</span> <span class="cn">TRUE</span>,              <span class="co"># Assume equal variances</span></span>
<span>  lognorm <span class="op">=</span> <span class="cn">TRUE</span>,            <span class="co"># Log-normal distribution assumption</span></span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,          <span class="co"># Demonstrate equivalence for at least 1 endpoint</span></span>
<span>  adjust <span class="op">=</span> <span class="st">"bon"</span>,            <span class="co"># Bonferroni adjustment method</span></span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span>,               <span class="co"># Number of stochastic simulations</span></span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>                <span class="co"># Random seed for reproducibility</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. EUREF </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span><span class="co">#&gt;       (multiple primary endpoints, k =  1 )</span></span>
<span><span class="co">#&gt;     - Multiplicity Correction: Bonferroni </span></span>
<span><span class="co">#&gt;       Adjusted Significance Levels: alpha = 0.0167 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter       Value</span></span>
<span><span class="co">#&gt;          Total Sample Size          24</span></span>
<span><span class="co">#&gt;             Achieved Power        90.6</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 88.6 - 92.3</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>As mentioned in <a href="../articles/intropkg.html">the
Introduction</a>, Bonferroni adjustment is often overly conservative,
especially in scenarios with correlated tests. A less restrictive
alternative is the Sidak correction, which accounts for the joint
probability of all tests being non-significant, making it mathematically
less conservative than the Bonferroni method.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">N_mp_sid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.9</span>,               <span class="co"># Target power</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,              <span class="co"># Significance level</span></span>
<span>  mu_list <span class="op">=</span> <span class="va">mu_list</span>,         <span class="co"># List of means</span></span>
<span>  sigma_list <span class="op">=</span> <span class="va">sigma_list</span>,   <span class="co"># List of standard deviations</span></span>
<span>  list_comparator <span class="op">=</span> <span class="va">list_comparator</span>,  <span class="co"># Comparator configurations</span></span>
<span>  list_lequi.tol <span class="op">=</span> <span class="va">list_lequi.tol</span>,    <span class="co"># Lower equivalence boundaries</span></span>
<span>  list_uequi.tol <span class="op">=</span> <span class="va">list_uequi.tol</span>,    <span class="co"># Upper equivalence boundaries</span></span>
<span>  rho <span class="op">=</span> <span class="fl">0.6</span>,                 <span class="co"># Correlation between endpoints</span></span>
<span>  dtype <span class="op">=</span> <span class="st">"parallel"</span>,        <span class="co"># Trial design type</span></span>
<span>  ctype <span class="op">=</span> <span class="st">"ROM"</span>,             <span class="co"># Test type (Ratio of Means)</span></span>
<span>  vareq <span class="op">=</span> <span class="cn">TRUE</span>,              <span class="co"># Assume equal variances</span></span>
<span>  lognorm <span class="op">=</span> <span class="cn">TRUE</span>,            <span class="co"># Log-normal distribution assumption</span></span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,          <span class="co"># Demonstrate equivalence for at least 1 endpoint</span></span>
<span>  adjust <span class="op">=</span> <span class="st">"sid"</span>,            <span class="co"># Sidak adjustment method</span></span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span>,               <span class="co"># Number of stochastic simulations</span></span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>                <span class="co"># Random seed for reproducibility</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. EUREF </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span><span class="co">#&gt;       (multiple primary endpoints, k =  1 )</span></span>
<span><span class="co">#&gt;     - Multiplicity Correction: Sidak </span></span>
<span><span class="co">#&gt;       Adjusted Significance Levels: alpha = 0.017 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter       Value</span></span>
<span><span class="co">#&gt;          Total Sample Size          24</span></span>
<span><span class="co">#&gt;             Achieved Power        90.6</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 88.6 - 92.3</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k&gt;1</annotation></semantics></math>,
Bonferroni and Sidak correction methods become increasingly
conservative. A more flexible approach is the <em>k</em>-adjustment,
which specifically accounts for the number of tests and the number of
endpoints required for equivalence.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">N_mp_k</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.9</span>,               <span class="co"># Target power</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,              <span class="co"># Significance level</span></span>
<span>  mu_list <span class="op">=</span> <span class="va">mu_list</span>,         <span class="co"># List of means</span></span>
<span>  sigma_list <span class="op">=</span> <span class="va">sigma_list</span>,   <span class="co"># List of standard deviations</span></span>
<span>  list_comparator <span class="op">=</span> <span class="va">list_comparator</span>,  <span class="co"># Comparator configurations</span></span>
<span>  list_lequi.tol <span class="op">=</span> <span class="va">list_lequi.tol</span>,    <span class="co"># Lower equivalence boundaries</span></span>
<span>  list_uequi.tol <span class="op">=</span> <span class="va">list_uequi.tol</span>,    <span class="co"># Upper equivalence boundaries</span></span>
<span>  rho <span class="op">=</span> <span class="fl">0.6</span>,                 <span class="co"># Correlation between endpoints</span></span>
<span>  dtype <span class="op">=</span> <span class="st">"parallel"</span>,        <span class="co"># Trial design type</span></span>
<span>  ctype <span class="op">=</span> <span class="st">"ROM"</span>,             <span class="co"># Test type (Ratio of Means)</span></span>
<span>  vareq <span class="op">=</span> <span class="cn">TRUE</span>,              <span class="co"># Assume equal variances</span></span>
<span>  lognorm <span class="op">=</span> <span class="cn">TRUE</span>,            <span class="co"># Log-normal distribution assumption</span></span>
<span>  k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,          <span class="co"># Demonstrate equivalence for at least 2 endpoints</span></span>
<span>  adjust <span class="op">=</span> <span class="st">"k"</span>,              <span class="co"># Adjustment method</span></span>
<span>  nsim <span class="op">=</span> <span class="fl">1000</span>,               <span class="co"># Number of stochastic simulations</span></span>
<span>  seed <span class="op">=</span> <span class="fl">1234</span>                <span class="co"># Random seed for reproducibility</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. EUREF </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span><span class="co">#&gt;       (multiple primary endpoints, k =  2 )</span></span>
<span><span class="co">#&gt;     - Multiplicity Correction: k-adjustment </span></span>
<span><span class="co">#&gt;       Adjusted Significance Levels: alpha = 0.0333 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter       Value</span></span>
<span><span class="co">#&gt;          Total Sample Size          54</span></span>
<span><span class="co">#&gt;             Achieved Power        91.6</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 89.7 - 93.2</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="hierarchical-testing">Hierarchical Testing of Endpoints<a class="anchor" aria-label="anchor" href="#hierarchical-testing"></a>
</h3>
<p>Hierarchical testing is a structured approach that allows for a more
nuanced evaluation of endpoints. Unlike a simple setup where at least
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
endpoints must pass, hierarchical testing enforces that some endpoints
are more critical and must always pass before proceeding to secondary
endpoints. This ensures that primary endpoints receive higher priority,
while still allowing flexibility in the evaluation of secondary
endpoints.</p>
<p>In this example, the trial follows a hierarchical testing strategy,
with Cmax as the primary endpoint. Equivalence testing begins with Cmax;
if established, the analysis proceeds to the secondary endpoints AUCinf
and AUClast. The trial is considered successful if equivalence holds for
Cmax and at least one
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k \geq 1</annotation></semantics></math>)
of the secondary endpoints.</p>
<p>To implement this advanced hierarchical testing approach in SimTOST,
we:</p>
<ol style="list-style-type: decimal">
<li>Use hierarchical testing by setting
<code>adjust = "seq"</code>.</li>
<li>Define the endpoint hierarchy using the <code>type_y</code>
argument:
<ul>
<li>Primary endpoint: <code>Cmax</code> (coded as 1) is the most
critical endpoint and must always pass.</li>
<li>Secondary endpoints: <code>AUCinf</code> and <code>AUClast</code>
(coded as 2) are less critical and only evaluated if <code>Cmax</code>
passes.</li>
</ul>
</li>
<li>Set <code>k=1</code>, ensuring that at least one of the two
secondary endpoints (<code>AUCinf</code> or <code>AUClast</code>) must
pass for the trial to be considered successful.</li>
</ol>
<p>The following code demonstrates how to apply hierarchical testing in
SimTOST</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">N_mp_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span></span>
<span>  power           <span class="op">=</span> <span class="fl">0.9</span>,                              <span class="co"># Target power</span></span>
<span>  alpha           <span class="op">=</span> <span class="fl">0.05</span>,                             <span class="co"># Significance level</span></span>
<span>  mu_list         <span class="op">=</span> <span class="va">mu_list</span>,                          <span class="co"># List of means</span></span>
<span>  sigma_list      <span class="op">=</span> <span class="va">sigma_list</span>,                       <span class="co"># List of standard deviations</span></span>
<span>  list_comparator <span class="op">=</span> <span class="va">list_comparator</span>,                  <span class="co"># Comparator configurations</span></span>
<span>  list_lequi.tol  <span class="op">=</span> <span class="va">list_lequi.tol</span>,                   <span class="co"># Lower equivalence boundaries</span></span>
<span>  list_uequi.tol  <span class="op">=</span> <span class="va">list_uequi.tol</span>,                   <span class="co"># Upper equivalence boundaries</span></span>
<span>  rho             <span class="op">=</span> <span class="fl">0.6</span>,                              <span class="co"># Correlation between endpoints</span></span>
<span>  dtype           <span class="op">=</span> <span class="st">"parallel"</span>,                       <span class="co"># Trial design type</span></span>
<span>  ctype           <span class="op">=</span> <span class="st">"ROM"</span>,                            <span class="co"># Test type (Ratio of Means)</span></span>
<span>  vareq           <span class="op">=</span> <span class="cn">TRUE</span>,                             <span class="co"># Assume equal variances</span></span>
<span>  lognorm         <span class="op">=</span> <span class="cn">TRUE</span>,                             <span class="co"># Log-normal distribution assumption</span></span>
<span>  adjust          <span class="op">=</span> <span class="st">"seq"</span>,                            <span class="co"># Sequential adjustment method</span></span>
<span>  type_y          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUCinf"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"AUClast"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"Cmax"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="co"># Endpoint types</span></span>
<span>  k               <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EMA"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,                     <span class="co"># Demonstrate equivalence for all 3 endpoints</span></span>
<span>  nsim            <span class="op">=</span> <span class="fl">1000</span>,                             <span class="co"># Number of stochastic simulations</span></span>
<span>  seed            <span class="op">=</span> <span class="fl">1234</span>                              <span class="co"># Random seed for reproducibility</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. EUREF </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span><span class="co">#&gt;       (multiple primary endpoints, k =  1 )</span></span>
<span><span class="co">#&gt;     - Multiplicity Correction: Sequential </span></span>
<span><span class="co">#&gt;       Adjusted Significance Levels: alpha = 0.025; 0.025; 0.050 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter       Value</span></span>
<span><span class="co">#&gt;          Total Sample Size          58</span></span>
<span><span class="co">#&gt;             Achieved Power        91.3</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 89.3 - 92.9</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>The hierarchical testing strategy ensured that Cmax, the primary
endpoint, had to pass before testing proceeded to the secondary
endpoints AUCinf and AUClast. If Cmax failed, the trial was considered
unsuccessful without evaluating the secondary endpoints. However, if
Cmax passed, at least one of the two secondary endpoints had to
demonstrate equivalence for the trial to be considered successful.</p>
<p>In this particular study design, a total of 58 patients were required
to achieve an overall power of 90%. Previously, 54 patients were
sufficient to demonstrate equivalence for at least two endpoints without
enforcing a hierarchical structure. The increase in sample size by 4
additional patients was necessary to ensure equivalence for Cmax, the
designated primary endpoint. This highlights the impact of hierarchical
testing, where primary endpoints must be adequately powered before
secondary endpoints are considered.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-shin_randomized_2015" class="csl-entry">
Shin, Donghoon, Youngdoe Kim, Yoo Seok Kim, Thomas Körnicke, and Rainard
Fuhr. 2015. <span>“A <span>Randomized</span>, <span>Phase I
Pharmacokinetic Study Comparing SB2</span> and <span>Infliximab
Reference Product</span> (<span>Remicade</span><span></span>) in
<span>Healthy Subjects</span>.”</span> <em>BioDrugs</em> 29 (6): 381–88.
<a href="https://doi.org/10.1007/s40259-015-0150-5" class="external-link">https://doi.org/10.1007/s40259-015-0150-5</a>.
</div>
<div id="ref-sozu_sample_2015" class="csl-entry">
Sozu, Takashi, Tomoyuki Sugimoto, Toshimitsu Hamasaki, and Scott R.
Evans. 2015. <em>Sample <span>Size Determination</span> in
<span>Clinical Trials</span> with <span>Multiple Endpoints</span></em>.
<span>SpringerBriefs</span> in <span>Statistics</span>. Cham: Springer
International Publishing. <a href="https://doi.org/10.1007/978-3-319-22005-5" class="external-link">https://doi.org/10.1007/978-3-319-22005-5</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Thomas Debray, Johanna Munoz, Biogen Inc.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
