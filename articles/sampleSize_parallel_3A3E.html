<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bioequivalence Tests for Parallel Trial Designs: 3 Arms, 3 Endpoints • SimTOST</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Bioequivalence Tests for Parallel Trial Designs: 3 Arms, 3 Endpoints">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SimTOST</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intopkg.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/sampleSize_crossover.html">Bioequivalence Tests for 2x2 Cross-Over Trial Designs with Log-Normal Data</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_2A3E.html">Bioequivalence Tests for Parallel Trial Designs: 2 Arms, 3 Endpoints</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_3A1E.html">Bioequivalence Tests for Parallel Trial Designs: 3 Arms, 1 Endpoint</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_3A3E.html">Bioequivalence Tests for Parallel Trial Designs: 3 Arms, 3 Endpoints</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel.html">Bioequivalence Tests for Parallel Trial Designs with Log-Normal Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/smartdata-analysis-and-statistics/SimTOST/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><script src="sampleSize_parallel_3A3E_files/kePrint-0.0.1/kePrint.js"></script><link href="sampleSize_parallel_3A3E_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Bioequivalence Tests for Parallel Trial Designs:
3 Arms, 3 Endpoints</h1>
                        <h4 data-toc-skip class="author">Thomas
Debray</h4>
            
            <h4 data-toc-skip class="date">January 11, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/smartdata-analysis-and-statistics/SimTOST/blob/main/vignettes/sampleSize_parallel_3A3E.Rmd" class="external-link"><code>vignettes/sampleSize_parallel_3A3E.Rmd</code></a></small>
      <div class="hidden name"><code>sampleSize_parallel_3A3E.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Similar to the example presented in <a href="sampleSize_parallel_2A3E.html">Bioequivalence Tests for Parallel
Trial Designs: 2 Arms, 3 Endpoints</a>, where equivalence across
multiple endpoints was assessed, we now extend the framework to trials
involving two reference products. This scenario arises when regulators
from different regions require comparisons with their locally sourced
reference biosimilars.</p>
<p>In many studies, it is necessary to evaluate equivalence across
multiple primary variables. For example, the European Medicines Agency
(EMA) recommends demonstrating equivalence for both the Area Under the
Curve (AUC) and the maximum concentration (Cmax) when assessing
pharmacokinetic properties. However, in this case, we evaluate
equivalence across three treatment arms, including a test biosimilar and
two reference products, each sourced from a different regulatory
region.</p>
<p>This vignette demonstrates advanced techniques for calculating sample
size in such trials, where both multiple endpoints and multiple
reference products are considered. As an illustrative example, we use
data from the phase-1 trial <a href="https://clinicaltrials.gov/study/NCT01922336#study-overview" class="external-link">NCT01922336</a>,
which assessed pharmacokinetics following a single dose of SB2, its
EU-sourced reference product (EU-INF), and its US-sourced reference
product (US-INF) <span class="citation">(<a href="#ref-shin_randomized_2015">Shin et al. 2015</a>)</span>.</p>
<table class="table table table-striped" style="margin-left: auto; margin-right: auto;">
<caption>
Primary PK measures between test and reference product. Data represent
arithmetic mean +- standard deviation.
</caption>
<thead><tr>
<th style="text-align:left;">
PK measure
</th>
<th style="text-align:left;">
SB2
</th>
<th style="text-align:left;">
EU-INF
</th>
<th style="text-align:left;">
US-INF
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
AUCinf
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>g*h/mL)
</td>
<td style="text-align:left;">
38,703
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
11,114
</td>
<td style="text-align:left;">
39,360
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
12,332
</td>
<td style="text-align:left;">
39,270
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
10,064
</td>
</tr>
<tr>
<td style="text-align:left;">
AUClast
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>g*h/mL)
</td>
<td style="text-align:left;">
36,862
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
9133
</td>
<td style="text-align:left;">
37,022
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
9398
</td>
<td style="text-align:left;">
37,368
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
8332
</td>
</tr>
<tr>
<td style="text-align:left;">
Cmax
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>g/mL)
</td>
<td style="text-align:left;">
127.0
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
16.9
</td>
<td style="text-align:left;">
126.2
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
17.9
</td>
<td style="text-align:left;">
129.2
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>±</mo><annotation encoding="application/x-tex">\pm</annotation></semantics></math>
18.8
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="input-data">Input Data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>As in <a href="sampleSize_parallel_2A3E.html">this vignette</a>, the
following inputs are required:</p>
<ul>
<li>Means for each endpoint and treatment arm
(<code>mu_list</code>),</li>
<li>Standard deviations for each endpoint and arm
(<code>sigma_list</code>),</li>
<li>Endpoint and arm names (<code>yname_list</code> and
<code>arm_names</code>),</li>
<li>Arms to be compared within each comparator
(<code>list_comparator</code>),</li>
<li>Endpoints to be compared within each comparator
(<code>list_y_comparator</code>).</li>
</ul>
<p>In this example, we simultaneously compare each biosimilar:</p>
<ul>
<li>SB2 vs. EU Remicade</li>
<li>SB2 vs. US Remicade</li>
</ul>
<p>Below is the R code to define the required data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mean values for each endpoint and arm</span></span>
<span><span class="va">mu_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  SB2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">38703</span>, AUClast <span class="op">=</span> <span class="fl">36862</span>, Cmax <span class="op">=</span> <span class="fl">127.0</span><span class="op">)</span>,</span>
<span>  EUINF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">39360</span>, AUClast <span class="op">=</span> <span class="fl">37022</span>, Cmax <span class="op">=</span> <span class="fl">126.2</span><span class="op">)</span>,</span>
<span>  USINF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">39270</span>, AUClast <span class="op">=</span> <span class="fl">37368</span>, Cmax <span class="op">=</span> <span class="fl">129.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Standard deviation values for each endpoint and arm</span></span>
<span><span class="va">sigma_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  SB2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">11114</span>, AUClast <span class="op">=</span> <span class="fl">9133</span>, Cmax <span class="op">=</span> <span class="fl">16.9</span><span class="op">)</span>,</span>
<span>  EUINF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">12332</span>, AUClast <span class="op">=</span> <span class="fl">9398</span>, Cmax <span class="op">=</span> <span class="fl">17.9</span><span class="op">)</span>,</span>
<span>  USINF <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">10064</span>, AUClast <span class="op">=</span> <span class="fl">8332</span>, Cmax <span class="op">=</span> <span class="fl">18.8</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simultaneous-testing-of-independent-co-primary-endpoints">Simultaneous Testing of Independent Co-Primary Endpoints<a class="anchor" aria-label="anchor" href="#simultaneous-testing-of-independent-co-primary-endpoints"></a>
</h2>
<p>In this analysis, we adopt the <strong>Ratio of Means (ROM)</strong>
approach to evaluate bioequivalence across independent co-primary
endpoints.</p>
<div class="section level3">
<h3 id="different-hypotheses-across-endpoints">Different Hypotheses across endpoints<a class="anchor" aria-label="anchor" href="#different-hypotheses-across-endpoints"></a>
</h3>
<p>In this example, we aim to demonstrate:</p>
<ul>
<li>Bioequivalence of SB2 vs. EU-INF for AUCinf and Cmax, and</li>
<li>Bioequivalence of SB2 vs. US-INF for AUClast and Cmax.</li>
</ul>
<p>The comparisons can be specified as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Arms to be compared</span></span>
<span><span class="va">list_comparator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  EMA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>, <span class="st">"EUINF"</span><span class="op">)</span>,</span>
<span>  FDA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>, <span class="st">"USINF"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Endpoints to be compared</span></span>
<span><span class="va">list_y_comparator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  EMA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUCinf"</span>, <span class="st">"Cmax"</span><span class="op">)</span>,</span>
<span>  FDA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUClast"</span>, <span class="st">"Cmax"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For all endpoints, bioequivalence is established if the 90%
confidence intervals for the ratios of the geometric means fall within
the equivalence range of 80.00% to 125.00%.</p>
<p>Below is the R code to define the equivalence boundaries for each
comparison:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define comparators and equivalence boundaries</span></span>
<span><span class="va">list_comparator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"EMA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>, <span class="st">"EUINF"</span><span class="op">)</span>,</span>
<span>  <span class="st">"FDA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span>, <span class="st">"USINF"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">list_lequi.tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"EMA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">0.8</span>, Cmax <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>  <span class="st">"FDA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUClast <span class="op">=</span> <span class="fl">0.8</span>, Cmax <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">list_uequi.tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"EMA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">1.25</span>, Cmax <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span>,</span>
<span>  <span class="st">"FDA"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUClast <span class="op">=</span> <span class="fl">1.25</span>, Cmax <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Here, the <code>list_comparator</code> parameter specifies the arms
being compared, while <code>list_lequi.tol</code> and
<code>list_uequi.tol</code> define the lower and upper equivalence
boundaries for the endpoints under consideration.</p>
<p>To calculate the required sample size for testing equivalence under
the specified conditions, we use the <a href="../reference/sampleSize.html">sampleSize()</a> function from the
SimTOST package. This function computes the total sample size needed to
achieve the target power while ensuring equivalence criteria are
met.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/smartdata-analysis-and-statistics/SimTOST" class="external-link">SimTOST</a></span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">N_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">0.9</span>,        <span class="co"># Target power</span></span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.05</span>,      <span class="co"># Type I error rate</span></span>
<span>                    mu_list <span class="op">=</span> <span class="va">mu_list</span>, <span class="co"># Means for each endpoint and arm</span></span>
<span>                    sigma_list <span class="op">=</span> <span class="va">sigma_list</span>, <span class="co"># Standard deviations</span></span>
<span>                    list_comparator <span class="op">=</span> <span class="va">list_comparator</span>, <span class="co"># Comparator arms</span></span>
<span>                    list_y_comparator <span class="op">=</span> <span class="va">list_y_comparator</span>, <span class="co"># Endpoints to compare</span></span>
<span>                    list_lequi.tol <span class="op">=</span> <span class="va">list_lequi.tol</span>, <span class="co"># Lower equivalence boundaries</span></span>
<span>                    list_uequi.tol <span class="op">=</span> <span class="va">list_uequi.tol</span>, <span class="co"># Upper equivalence boundaries</span></span>
<span>                    dtype <span class="op">=</span> <span class="st">"parallel"</span>, <span class="co"># Trial design type</span></span>
<span>                    ctype <span class="op">=</span> <span class="st">"ROM"</span>,      <span class="co"># Test type: Ratio of Means</span></span>
<span>                    vareq <span class="op">=</span> <span class="cn">TRUE</span>,       <span class="co"># Assume equal variances</span></span>
<span>                    lognorm <span class="op">=</span> <span class="cn">TRUE</span>,     <span class="co"># Log-normal distribution assumption</span></span>
<span>                    ncores <span class="op">=</span> <span class="fl">1</span>,         <span class="co"># Number of cores for computation</span></span>
<span>                    nsim <span class="op">=</span> <span class="fl">1000</span>,        <span class="co"># Number of stochastic simulations</span></span>
<span>                    seed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span><span class="op">)</span>       <span class="co"># Random seed for reproducibility</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. EUINF </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: AUCinf, Cmax </span></span>
<span><span class="co">#&gt;       (multiple co-primary endpoints, m =  2 )</span></span>
<span><span class="co">#&gt;    SB2 vs. USINF </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: AUClast, Cmax </span></span>
<span><span class="co">#&gt;       (multiple co-primary endpoints, m =  2 )</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter       Value</span></span>
<span><span class="co">#&gt;          Total Sample Size         117</span></span>
<span><span class="co">#&gt;             Achieved Power          90</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 87.9 - 91.8</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>We find a total sample size of
N_ss<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mi>e</mi><mi>s</mi><mi>p</mi><mi>o</mi><mi>n</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">response</annotation></semantics></math>n_total
patients (or 39 per arm) are required to demonstrate equivalence.</p>
</div>
</div>
<div class="section level2">
<h2 id="simultaneous-testing-of-independent-primary-endpoints">Simultaneous Testing of Independent Primary Endpoints<a class="anchor" aria-label="anchor" href="#simultaneous-testing-of-independent-primary-endpoints"></a>
</h2>
<div class="section level3">
<h3 id="equivalence-for-at-least-2-of-the-3-endpoints-with-bonferroni-adjustment">Equivalence for At Least 2 of the 3 Endpoints with Bonferroni
Adjustment<a class="anchor" aria-label="anchor" href="#equivalence-for-at-least-2-of-the-3-endpoints-with-bonferroni-adjustment"></a>
</h3>
<p>In this example, we aim to establish equivalence for at least two out
of three primary endpoints while accounting for multiplicity using the
Bonferroni adjustment. The following assumptions are made:</p>
<ul>
<li>Equality of Variances: Variances are assumed to be equal across
groups (<code>vareq = TRUE</code>).</li>
<li>Testing Parameter: The Ratio of Means (ROM) is used as the testing
parameter (<code>ctype = "ROM"</code>).</li>
<li>Design: A parallel trial design is assumed
(<code>dtype = "parallel"</code>).</li>
<li>Distribution: Endpoint data follows a log-normal distribution
(<code>lognorm = TRUE</code>).</li>
<li>Correlation: Endpoints are assumed to be independent, with no
correlation between them (default <code>rho = 0</code>).</li>
<li>Multiplicity Adjustment: The Bonferroni correction is applied to
control for Type I error (<code>adjust = "bon"</code>).</li>
<li>Equivalence Criterion: Equivalence is required for at least two of
the three endpoints (<code>k = 2</code>).</li>
</ul>
<p>The comparisons and equivalence boundaries can be defined as
follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Endpoints to be compared for each comparator</span></span>
<span><span class="va">list_y_comparator</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  EMA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUCinf"</span>, <span class="st">"AUClast"</span>, <span class="st">"Cmax"</span><span class="op">)</span>,</span>
<span>  FDA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUCinf"</span>, <span class="st">"AUClast"</span>, <span class="st">"Cmax"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define lower equivalence boundaries for each comparator</span></span>
<span><span class="va">list_lequi.tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  EMA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">0.8</span>, AUClast <span class="op">=</span> <span class="fl">0.8</span>, Cmax <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>  FDA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">0.8</span>, AUClast <span class="op">=</span> <span class="fl">0.8</span>, Cmax <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define upper equivalence boundaries for each comparator</span></span>
<span><span class="va">list_uequi.tol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  EMA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">1.25</span>, AUClast <span class="op">=</span> <span class="fl">1.25</span>, Cmax <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span>,</span>
<span>  FDA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>AUCinf <span class="op">=</span> <span class="fl">1.25</span>, AUClast <span class="op">=</span> <span class="fl">1.25</span>, Cmax <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Finally, we calculate the required sample size:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">N_mp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">0.9</span>,       <span class="co"># Target power</span></span>
<span>                    alpha <span class="op">=</span> <span class="fl">0.05</span>,      <span class="co"># Type I error rate</span></span>
<span>                    mu_list <span class="op">=</span> <span class="va">mu_list</span>, <span class="co"># Means for each endpoint and arm</span></span>
<span>                    sigma_list <span class="op">=</span> <span class="va">sigma_list</span>, <span class="co"># Standard deviations</span></span>
<span>                    list_comparator <span class="op">=</span> <span class="va">list_comparator</span>, <span class="co"># Comparator arms</span></span>
<span>                    list_y_comparator <span class="op">=</span> <span class="va">list_y_comparator</span>, <span class="co"># Endpoints to compare</span></span>
<span>                    list_lequi.tol <span class="op">=</span> <span class="va">list_lequi.tol</span>, <span class="co"># Lower equivalence boundaries</span></span>
<span>                    list_uequi.tol <span class="op">=</span> <span class="va">list_uequi.tol</span>, <span class="co"># Upper equivalence boundaries</span></span>
<span>                    k <span class="op">=</span> <span class="fl">2</span>,              <span class="co"># Number of endpoints required to demonstrate equivalence</span></span>
<span>                    adjust <span class="op">=</span> <span class="st">"bon"</span>,     <span class="co"># Bonferroni adjustment for multiple comparisons</span></span>
<span>                    dtype <span class="op">=</span> <span class="st">"parallel"</span>, <span class="co"># Trial design type (parallel group)</span></span>
<span>                    ctype <span class="op">=</span> <span class="st">"ROM"</span>,      <span class="co"># Test type: Ratio of Means</span></span>
<span>                    vareq <span class="op">=</span> <span class="cn">TRUE</span>,       <span class="co"># Assume equal variances across arms</span></span>
<span>                    lognorm <span class="op">=</span> <span class="cn">TRUE</span>,     <span class="co"># Log-normal distribution assumption</span></span>
<span>                    ncores <span class="op">=</span> <span class="fl">1</span>,         <span class="co"># Number of cores for computation</span></span>
<span>                    nsim <span class="op">=</span> <span class="fl">1000</span>,        <span class="co"># Number of stochastic simulations</span></span>
<span>                    seed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span><span class="op">)</span>       <span class="co"># Random seed for reproducibility</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. EUINF </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span><span class="co">#&gt;       (multiple primary endpoints, k =  2 )</span></span>
<span><span class="co">#&gt;     - Multiplicity Correction: Bonferroni </span></span>
<span><span class="co">#&gt;       - Adjusted Significance Levels: alpha = 0.0167 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    SB2 vs. USINF </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span><span class="co">#&gt;       (multiple primary endpoints, k =  2 )</span></span>
<span><span class="co">#&gt;     - Multiplicity Correction: Bonferroni </span></span>
<span><span class="co">#&gt;       - Adjusted Significance Levels: alpha = 0.0167 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter       Value</span></span>
<span><span class="co">#&gt;          Total Sample Size          93</span></span>
<span><span class="co">#&gt;             Achieved Power          90</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 87.9 - 91.8</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="unequal-allocation-rates-across-arms">Unequal Allocation Rates Across Arms<a class="anchor" aria-label="anchor" href="#unequal-allocation-rates-across-arms"></a>
</h3>
<p>In this example, we build upon the previous setting but introduce
unequal allocation rates across the treatment arms. Specifically, we
require that the number of patients in the new treatment arm is double
the number in each of the reference arms.</p>
<p>This can be achieved by specifying the treatment allocation rate
parameter (<code>TAR</code>). The rates are provided as a vector, for
example: <code>TAR = c(2, 1, 1)</code>. This ensures that for every two
patients assigned to the new treatment arm, one patient is assigned to
each reference arm.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">N_mp2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sampleSize.html">sampleSize</a></span><span class="op">(</span>power <span class="op">=</span> <span class="fl">0.9</span>,       <span class="co"># Target power</span></span>
<span>                     alpha <span class="op">=</span> <span class="fl">0.05</span>,      <span class="co"># Type I error rate</span></span>
<span>                     mu_list <span class="op">=</span> <span class="va">mu_list</span>, <span class="co"># Means for each endpoint and arm</span></span>
<span>                     sigma_list <span class="op">=</span> <span class="va">sigma_list</span>, <span class="co"># Standard deviations</span></span>
<span>                     list_comparator <span class="op">=</span> <span class="va">list_comparator</span>, <span class="co"># Comparator arms</span></span>
<span>                     list_y_comparator <span class="op">=</span> <span class="va">list_y_comparator</span>, <span class="co"># Endpoints to compare</span></span>
<span>                     list_lequi.tol <span class="op">=</span> <span class="va">list_lequi.tol</span>, <span class="co"># Lower equivalence boundaries</span></span>
<span>                     list_uequi.tol <span class="op">=</span> <span class="va">list_uequi.tol</span>, <span class="co"># Upper equivalence boundaries</span></span>
<span>                     k <span class="op">=</span> <span class="fl">2</span>,              <span class="co"># Number of endpoints required to demonstrate equivalence</span></span>
<span>                     adjust <span class="op">=</span> <span class="st">"bon"</span>,     <span class="co"># Bonferroni adjustment for multiple comparisons</span></span>
<span>                     TAR <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SB2"</span> <span class="op">=</span> <span class="fl">2</span>, <span class="st">"EUINF"</span> <span class="op">=</span> <span class="fl">1</span>, <span class="st">"USINF"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, <span class="co"># Treatment allocation rates</span></span>
<span>                     dtype <span class="op">=</span> <span class="st">"parallel"</span>, <span class="co"># Trial design type (parallel group)</span></span>
<span>                     ctype <span class="op">=</span> <span class="st">"ROM"</span>,      <span class="co"># Test type: Ratio of Means</span></span>
<span>                     vareq <span class="op">=</span> <span class="cn">TRUE</span>,       <span class="co"># Assume equal variances across arms</span></span>
<span>                     lognorm <span class="op">=</span> <span class="cn">TRUE</span>,     <span class="co"># Log-normal distribution assumption</span></span>
<span>                     ncores <span class="op">=</span> <span class="fl">1</span>,         <span class="co"># Number of cores for computation</span></span>
<span>                     nsim <span class="op">=</span> <span class="fl">1000</span>,        <span class="co"># Number of stochastic simulations</span></span>
<span>                     seed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span><span class="op">)</span>       <span class="co"># Random seed for reproducibility</span></span>
<span><span class="co">#&gt; Sample Size Calculation Results</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt; Study Design: parallel trial targeting 90% power with a 5% type-I error.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Comparisons:</span></span>
<span><span class="co">#&gt;    SB2 vs. EUINF </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span><span class="co">#&gt;       (multiple primary endpoints, k =  2 )</span></span>
<span><span class="co">#&gt;     - Multiplicity Correction: Bonferroni </span></span>
<span><span class="co">#&gt;       - Adjusted Significance Levels: alpha = 0.0167 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    SB2 vs. USINF </span></span>
<span><span class="co">#&gt;     - Endpoints Tested: AUCinf, AUClast, Cmax </span></span>
<span><span class="co">#&gt;       (multiple primary endpoints, k =  2 )</span></span>
<span><span class="co">#&gt;     - Multiplicity Correction: Bonferroni </span></span>
<span><span class="co">#&gt;       - Adjusted Significance Levels: alpha = 0.0167 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                  Parameter       Value</span></span>
<span><span class="co">#&gt;          Total Sample Size          96</span></span>
<span><span class="co">#&gt;             Achieved Power          90</span></span>
<span><span class="co">#&gt;  Power Confidence Interval 87.9 - 91.8</span></span>
<span><span class="co">#&gt; -------------------------------------------------------------</span></span></code></pre></div>
<p>Results from the simulation indicate that 48 patients are required
for SB2 the active treatment arm (SB2), and 24 patients are required for
each reference arm. The total sample size required is 96. This is
significantly larger compared to the previous example, where the total
sample size was 93.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-shin_randomized_2015" class="csl-entry">
Shin, Donghoon, Youngdoe Kim, Yoo Seok Kim, Thomas Körnicke, and Rainard
Fuhr. 2015. <span>“A <span>Randomized</span>, <span>Phase I
Pharmacokinetic Study Comparing SB2</span> and <span>Infliximab
Reference Product</span> (<span>Remicade</span><span></span>) in
<span>Healthy Subjects</span>.”</span> <em>BioDrugs</em> 29 (6): 381–88.
<a href="https://doi.org/10.1007/s40259-015-0150-5" class="external-link">https://doi.org/10.1007/s40259-015-0150-5</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Thomas Debray, Johanna Muñoz, Dewi Amaliah, Biogen Inc.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
