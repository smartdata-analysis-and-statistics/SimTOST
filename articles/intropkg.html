<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction • SimTOST</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SimTOST</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intropkg.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/sampleSize_crossover.html">Bioequivalence Tests for 2x2 Cross-Over Trial Designs with Log-Normal Data</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_2A1E.html">Bioequivalence Tests for Parallel Trial Designs: 2 Arms, 1 Endpoint</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_2A3E.html">Bioequivalence Tests for Parallel Trial Designs: 2 Arms, 3 Endpoints</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_3A1E.html">Bioequivalence Tests for Parallel Trial Designs: 3 Arms, 1 Endpoint</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel_3A3E.html">Bioequivalence Tests for Parallel Trial Designs: 3 Arms, 3 Endpoints</a>
    </li>
    <li>
      <a href="../articles/sampleSize_parallel.html">Bioequivalence Tests for Parallel Trial Designs with Log-Normal Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction</h1>
            
      

      <div class="hidden name"><code>intropkg.Rmd</code></div>

    </div>

    
    
<p>In the <code>SimTOST</code> R package, which is specifically designed
for sample size estimation for bioequivalence studies, hypothesis
testing is based on the Two One-Sided Tests (TOST) procedure. <span class="citation">(<a href="#ref-sozu_sample_2015">Sozu et al.
2015b</a>)</span> In TOST, the equivalence test is framed as a
comparison between the the null hypothesis of ‘new product is worse by a
clinically relevant quantity’ and the alternative hypothesis of
‘difference between products is too small to be clinically
relevant’.</p>
<div class="section level2">
<h2 id="hypotheses">Hypotheses<a class="anchor" aria-label="anchor" href="#hypotheses"></a>
</h2>
<p>The null and alternative hypotheses for the equivalence test are
presented below for two different approaches:</p>
<div class="section level3">
<h3 id="difference-of-means-dom">Difference of Means (DOM)<a class="anchor" aria-label="anchor" href="#difference-of-means-dom"></a>
</h3>
<p>One common approach for assessing bio-equivalence involves comparing
pharmacokinetic (PK) measures between test and reference products. This
is done using the following interval (null) hypothesis:</p>
<p>Null Hypothesis
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>):
At least one endpoint does not meet the equivalence criteria:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msubsup><mi>m</mi><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>−</mo><msubsup><mi>m</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>≤</mo><msub><mi>δ</mi><mi>L</mi></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mtext mathvariant="normal">or</mtext><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><msubsup><mi>m</mi><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>−</mo><msubsup><mi>m</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>≥</mo><msub><mi>δ</mi><mi>U</mi></msub><mspace width="1.0em"></mspace><mtext mathvariant="normal">for at least one</mtext><mspace width="0.278em"></mspace><mi>j</mi></mrow><annotation encoding="application/x-tex">H_0: m_T^{(j)} - m_R^{(j)} \le \delta_L ~~ \text{or}~~ m_T^{(j)} - m_R^{(j)} \ge \delta_U \quad \text{for at least one}\;j</annotation></semantics></math></p>
<p>Alternative Hypothesis
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>):
All endpoints meet the equivalence criteria:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><msub><mi>δ</mi><mi>L</mi></msub><mo>&lt;</mo><msubsup><mi>m</mi><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>−</mo><msubsup><mi>m</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><mo>&lt;</mo><msub><mi>δ</mi><mi>U</mi></msub><mspace width="1.0em"></mspace><mtext mathvariant="normal">for all</mtext><mspace width="0.278em"></mspace><mi>j</mi></mrow><annotation encoding="application/x-tex">H_1: \delta_L&lt;m_{T}^{(j)}-m_{R}^{(j)} &lt;\delta_U \quad\text{for all}\;j</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>T</mi></msub><annotation encoding="application/x-tex">m_T</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>m</mi><mi>R</mi></msub><annotation encoding="application/x-tex">m_R</annotation></semantics></math>
represent the mean endpoints for the test product (the proposed
biosimilar) and the reference product, respectively. The equivalence
limits,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>L</mi></msub><annotation encoding="application/x-tex">\delta_L</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>δ</mi><mi>u</mi></msub><annotation encoding="application/x-tex">\delta_u</annotation></semantics></math>,
are typically chosen to be symmetric, such that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mo>−</mo><msub><mi>δ</mi><mi>L</mi></msub><mo>=</mo><msub><mi>δ</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">\delta = - \delta_L = \delta_U</annotation></semantics></math>.</p>
<p>The null hypothesis
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>)
is rejected if, and only if, all null hypotheses associated with the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>
primary endpoints are rejected at a significance level of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.
This ensures that equivalence is established across all endpoints
simultaneously.</p>
<p>The DOM test can be implemented in <a href="../reference/sampleSize.html">sampleSize()</a> by setting
<code>ctype = "DOM"</code> and <code>lognorm = FALSE</code>.</p>
<p>For pharmacokinetic (PK) outcomes, such as the area under the curve
(AUC) and maximum concentration (Cmax), log-transformation is commonly
applied to achieve normality. To perform this transformation, the
logarithm of the geometric mean should be provided to
<code>mu_list</code>, while the logarithmic variance can be derived from
the coefficient of variation (CV) using the formula:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Logarithmic Variance</mtext><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><msup><mtext mathvariant="normal">CV</mtext><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\text{Logarithmic Variance} = \log\left(1 + {\text{CV}^2}\right)
</annotation></semantics></math></p>
<p>Equivalence limits must also be specified on the log scale to align
with the transformed data.</p>
</div>
<div class="section level3">
<h3 id="ratio-of-means-rom">Ratio of Means (ROM)<a class="anchor" aria-label="anchor" href="#ratio-of-means-rom"></a>
</h3>
<p>The equivalence hypotheses can also be expressed as a Ratio of Means
(ROM):</p>
<p>Null Hypothesis
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_0</annotation></semantics></math>):
At least one endpoint does not meet the equivalence criteria:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mfrac><msubsup><mi>μ</mi><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msubsup><mi>μ</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mfrac><mo>≤</mo><msub><mi>E</mi><mi>L</mi></msub><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mtext mathvariant="normal">or</mtext><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mfrac><msubsup><mi>μ</mi><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msubsup><mi>μ</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mfrac><mo>≥</mo><msub><mi>E</mi><mi>U</mi></msub><mspace width="1.0em"></mspace><mtext mathvariant="normal">for at least one</mtext><mspace width="0.278em"></mspace><mi>j</mi></mrow><annotation encoding="application/x-tex">H_0: \frac{\mu_T^{(j)}}{\mu_R^{(j)}} \le E_L ~~ \text{or}~~ \frac{\mu_T^{(j)}}{\mu_R^{(j)}} \ge E_U \quad \text{for at least one}\;j</annotation></semantics></math></p>
<p>Alternative Hypothesis
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_1</annotation></semantics></math>):
All endpoints meet the equivalence criteria:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>1</mn></msub><mo>:</mo><msub><mi>E</mi><mi>L</mi></msub><mo>&lt;</mo><mfrac><msubsup><mi>μ</mi><mi>T</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup><msubsup><mi>μ</mi><mi>R</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>j</mi><mo stretchy="true" form="postfix">)</mo></mrow></msubsup></mfrac><mo>&lt;</mo><msub><mi>E</mi><mi>U</mi></msub><mspace width="1.0em"></mspace><mtext mathvariant="normal">for all</mtext><mspace width="0.278em"></mspace><mi>j</mi></mrow><annotation encoding="application/x-tex">H_1: E_L&lt; \frac{\mu_{T}^{(j)}}{\mu_{R}^{(j)}} &lt; E_U \quad\text{for all}\;j</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>T</mi></msub><annotation encoding="application/x-tex">\mu_T</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>μ</mi><mi>R</mi></msub><annotation encoding="application/x-tex">\mu_R</annotation></semantics></math>
represent the arithmetic mean endpoints for the test product (the
proposed biosimilar) and the reference product, respectively.</p>
<p>The ROM test can be implemented in <a href="../reference/sampleSize.html">sampleSize()</a> by setting
<code>ctype = "ROM"</code> and <code>lognorm = TRUE</code>. Note that
the <code>mu_list</code> argument should contain the arithmetic means of
the endpoints, while <code>sigma_list</code> should contain their
corresponding variances.</p>
<p>The ROM test is converted to a Difference of Means (DOM) tests by
log-transforming the data and equivalence limits. The variance on the
log scale is calculated using the normalized variance formula:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Logarithmic Variance</mtext><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mfrac><mtext mathvariant="normal">Arithmetic Variance</mtext><msup><mtext mathvariant="normal">Arithmetic Mean</mtext><mn>2</mn></msup></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\text{Logarithmic Variance} = \log\left(1 + \frac{\text{Arithmetic Variance}}{\text{Arithmetic Mean}^2}\right)
</annotation></semantics></math></p>
<p>The logarithmic mean is then calculated as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">Logarithmic Mean</mtext><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">Arithmetic Mean</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">Logarithmic Variance</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Logarithmic Mean} = \log(\text{Arithmetic Mean}) - \frac{1}{2}(\text{Logarithmic Variance})</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="regulatory-requirements">Regulatory Requirements<a class="anchor" aria-label="anchor" href="#regulatory-requirements"></a>
</h3>
<p>When evaluating bioequivalence, certain statistical and
methodological requirements must be adhered to, as outlined in the
European Medicines Agency’s bioequivalence guidelines <span class="citation">(<a href="#ref-CHMP2010">Committee for Medicinal
Products for Human Use (CHMP) 2010</a>)</span>. These requirements
ensure that the test and reference products meet predefined criteria for
equivalence in terms of PK parameters. The key considerations are
summarized below:</p>
<ul>
<li>Hypothesis testing should be based on the ratio of the population
geometric means</li>
<li>The 90% confidence interval for the ratio of the test and reference
products should be contained within the acceptance interval of 80.00 to
125.00%.</li>
<li>A margin of clinical equivalence
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Δ</mi><annotation encoding="application/x-tex">\Delta</annotation></semantics></math>)
is chosen by defining the largest difference that is clinically
acceptable, so that a difference larger than this would matter in
practice.</li>
<li>The data should be transformed prior to analysis using a logarithmic
transformation and subsequently be analyzed using ANOVA</li>
</ul>
<p>When conducting a DOM test, The FDA recommends that the equivalence
acceptance criterion (EAC) be defined as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mi>E</mi><mi>A</mi><mi>C</mi><mo>=</mo><mn>1.5</mn><msub><mi>σ</mi><mi>R</mi></msub></mrow><annotation encoding="application/x-tex">\delta = EAC = 1.5 \sigma_R</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>R</mi></msub><annotation encoding="application/x-tex">\sigma_R</annotation></semantics></math>
represents the variability of the log-transformed endpoint for the
reference product.</p>
</div>
</div>
<div class="section level2">
<h2 id="testing-of-multiple-endpoints">Testing of multiple endpoints<a class="anchor" aria-label="anchor" href="#testing-of-multiple-endpoints"></a>
</h2>
<p>Assessment of equivalence is often required for more than one primary
variable. <span class="citation">(<a href="#ref-sozu_sample_2015">Sozu
et al. 2015b</a>)</span> For example, EMA recommends showing equivalence
both for AUC and Cmax</p>
<p>A decision must be made as to whether it is desirable to</p>
<ul>
<li>Demonstrate equivalence for all primary endpoints
<ul>
<li>This is the most common setting and is often referred to as having
<em>multiple co-primary endpoints</em>.</li>
<li>Equivalence must be demonstrated for <strong>all</strong> endpoints
to conclude overall equivalence.</li>
</ul>
</li>
<li>Demonstrate equivalence for at least one of the primary endpoints
<ul>
<li>Known as having <em>multiple primary endpoints</em>.</li>
<li>Equivalence is required for <strong>at least one</strong> endpoint
to meet the study’s objectives.</li>
</ul>
</li>
</ul>
<div class="section level3">
<h3 id="testing-multiple-co-primary-endpoints">Testing multiple co-primary endpoints<a class="anchor" aria-label="anchor" href="#testing-multiple-co-primary-endpoints"></a>
</h3>
<p>When a trial defines multiple co-primary endpoints, equivalence must
be demonstrated for all of them to claim overall treatment equivalence.
In this setting, each endpoint is tested separately at the usual
significance level
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>),
and equivalence is established only if all individual tests are
statistically significant. Because conclusions require rejecting all
null hypotheses, a formal multiplicity adjustment is not needed to
control the Type I error rate. <span class="citation">(<a href="#ref-cpmp_points_2002">Committee for Propietary Medicinal Products
(CPMP) 2002</a>)</span> However, as the number of co-primary endpoints
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math>)
increases, the likelihood of failing to meet equivalence on at least one
endpoint also rises, resulting in a higher Type II error rate (i.e., a
greater risk of incorrectly concluding non-equivalence) <span class="citation">(<a href="#ref-mielke_sample_2018">Mielke et al.
2018</a>)</span></p>
<p>This has several important implications:</p>
<ul>
<li>
<strong>Reduced Power in Rare Diseases</strong>. Previous studies
have shown that the sample size required to maintain a given power level
increases as the number of endpoints increases. <span class="citation">(<a href="#ref-mielke_sample_2018">Mielke et al.
2018</a>)</span> This effect is particularly pronounced when the test
statistics are uncorrelated or when a large number of tests are
performed. In common conditions, this loss of power can often be
compensated by increasing the sample size. In rare diseases, however,
patient recruitment is often limited, making it more challenging to
achieve equivalence across all endpoints and increasing the risk of an
inconclusive result.</li>
<li>
<strong>Alternative Statistical Approaches</strong>. To address
power loss from requiring equivalence across multiple endpoints,
alternative methods have been proposed. For example, one option is to
power the study so that equivalence can be demonstrated for at least
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
tests, rather than requiring all endpoints to meet the equivalence
criterion. Another approach is hierarchical testing, where endpoints are
tested sequentially based on predefined rules, allowing for partial
conclusions when equivalence is demonstrated in a subset of endpoints.
See <a href="#multiple-primary">Testing multiple primary endpoints</a>
for more details.</li>
<li>
<strong>Regulatory Considerations</strong>. Regulatory agencies
often require a pre-specified statistical strategy to handle multiple
endpoints in equivalence trials. Without proper planning, the risk of
failing to establish equivalence in all endpoints may lead to
inconclusive results, even if the treatments are meaningfully
similar.</li>
</ul>
</div>
<div class="section level3">
<h3 id="multiple-primary">Testing multiple primary endpoints<a class="anchor" aria-label="anchor" href="#multiple-primary"></a>
</h3>
<p>When a trial aims to establish equivalence for at least
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
primary endpoints, adjustments are necessary to account for the
increased risk of Type I error due to multiple hypothesis testing <span class="citation">(<a href="#ref-sozu_continuous_2015">Sozu et al.
2015a</a>)</span>. Without such adjustments, the likelihood of
incorrectly concluding equivalence for at least one endpoint increases
as the number of endpoints grows.</p>
<p>For example, if a study includes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">m = 3</annotation></semantics></math>
independent primary endpoints and uses a significance level of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">\alpha = 5%</annotation></semantics></math>
for each test, the overall probability of falsely concluding equivalence
for at least one endpoint is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>–</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>m</mi></msup><mo>=</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mn>0.05</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>3</mn></msup><mo>=</mo><mn>0.1426</mn><mi>.</mi></mrow><annotation encoding="application/x-tex"> 1 – (1-\alpha)^m  = 1 - (1-0.05)^3 = 0.1426. </annotation></semantics></math>
This means that the overall probability of making any false positive
error, also known as the <strong>family-wise error rate (FWER)</strong>,
increases to approximately 14%.</p>
<p>To address this issue, adjustments to the significance level are
necessary for multiple endpoint comparisons for which various methods
have been proposed. In SimTOST, the following approaches are
included:</p>
<div class="section level4">
<h4 id="bonferroni-correction">Bonferroni correction<a class="anchor" aria-label="anchor" href="#bonferroni-correction"></a>
</h4>
<p>The most common and easiest procedure for multiplicity adjustment to
control the FWER is the Bonferroni method. Each hypothesis is tested at
level</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mrow><mi>b</mi><mi>o</mi><mi>n</mi></mrow></msub><mo>=</mo><mi>α</mi><mi>/</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">\alpha_{bon}= \alpha/m</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
is the total number of tests. Although simple, this method is highly
conservative, particularly when tests are correlated, as it assumes all
tests are independent. This conservativeness remains pronounced even for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k=1</annotation></semantics></math>,
where only one of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
hypotheses needs to be rejected. <span class="citation">(<a href="#ref-mielke_sample_2018">Mielke et al. 2018</a>)</span></p>
<p>In the <a href="../reference/sampleSize.html">sampleSize()</a>
function, the Bonferroni correction can be applied by setting
<code>adjust = "bon"</code>.</p>
</div>
<div class="section level4">
<h4 id="sidak-correction">Sidak correction<a class="anchor" aria-label="anchor" href="#sidak-correction"></a>
</h4>
<p>The Sidak correction is an alternative method for controlling the
FWER. Like the Bonferroni correction, it assumes that tests are
independent. However, the Sidak correction accounts for the joint
probability of all tests being non-significant, making it mathematically
less conservative than the Bonferroni method. The adjusted significance
level is calculated as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mrow><mi>s</mi><mi>i</mi><mi>d</mi></mrow></msub><mo>=</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mi>/</mi><mi>m</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\alpha_{sid}= 1-(1-\alpha)^ {1/m}</annotation></semantics></math></p>
<p>The Sidak correction can be implemented by specifying
<code>adjust = "sid"</code> in the <a href="../reference/sampleSize.html">sampleSize()</a> function.</p>
</div>
<div class="section level4">
<h4 id="k-adjustment">K adjustment<a class="anchor" aria-label="anchor" href="#k-adjustment"></a>
</h4>
<p>This correction explicitly accounts for the scenario where
equivalence is required for only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
out of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
endpoints. Unlike the Bonferroni and Sidak corrections, which assume
that all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
tests contribute equally to the overall Type I error rate, the
<em>k</em>-adjustment directly incorporates the number of endpoints
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>)
required for equivalence into the adjustment. The adjusted significance
level is calculated as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>k</mi></msub><mo>=</mo><mfrac><mrow><mi>k</mi><mo>*</mo><mi>α</mi></mrow><mi>m</mi></mfrac></mrow><annotation encoding="application/x-tex">\alpha_k= \frac{k*\alpha}{m}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
is the number of endpoints required for equivalence, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
is the total number of endpoints evaluated.</p>
</div>
</div>
<div class="section level3">
<h3 id="hierarchical-testing-of-multiple-endpoints">Hierarchical testing of multiple endpoints<a class="anchor" aria-label="anchor" href="#hierarchical-testing-of-multiple-endpoints"></a>
</h3>
<p>Hierarchical testing is an approach to multiple endpoint testing
where endpoints are tested in a predefined order, typically based on
their clinical or regulatory importance. A fallback testing strategy is
applied, allowing sequential hypothesis testing. If a hypothesis earlier
in the sequence fails to be rejected, testing stops, and subsequent
hypotheses are not evaluated. <span class="citation">(<a href="#ref-chowdhry_finding_2024">Chowdhry et al. 2024</a>)</span></p>
<p>To implement hierarchical testing in <code>simTOST</code>, the user
specifies <code>adjust = "seq"</code> in the <a href="../reference/sampleSize.html">sampleSize()</a> function and
defines primary and secondary endpoints using the <code>type_y</code>
vector argument. The significance level
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)
is adjusted separately for each group of endpoints, ensuring strong
control of the Family-Wise Error Rate (FWER) while maintaining
interpretability.</p>
<ol style="list-style-type: decimal">
<li>
<strong>Evaluate (co-)primary endpoints</strong>
<ul>
<li>Testing begins with the pre-specified (co-)primary endpoints at the
nominal significance level.</li>
<li>Equivalence must be demonstrated for <em>all</em> (co-)primary
endpoints.</li>
<li>If any primary endpoint fails to meet the equivalence criteria,
testing stops, and secondary endpoints are not evaluated.</li>
</ul>
</li>
<li>
<strong>Proceed to secondary endpoints (if applicable)</strong>
<ul>
<li>If all primary endpoints meet the equivalence criteria, testing
proceeds to the secondary endpoints.</li>
<li>Equivalence must be demonstrated for at least <code>k</code>
secondary endpoints.</li>
<li>The significance level for secondary endpoints is adjusted using
k-adjustment.</li>
</ul>
</li>
<li>
<strong>Final Decision</strong>
<ul>
<li>The test is considered successful if <em>all</em> (co-)primary
endpoints meet the equivalence criteria and at least <code>k</code>
secondary endpoints demonstrate equivalence.</li>
</ul>
</li>
</ol>
<p>An example of hierarchical testing can be found in <a href="sampleSize_parallel_2A3E.html#hierarchical-testing">this
vignette</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="testing-of-multiple-treatments">Testing of multiple treatments<a class="anchor" aria-label="anchor" href="#testing-of-multiple-treatments"></a>
</h2>
<p>In certain cases, it may be necessary to compare multiple treatments
simultaneously. This can be achieved by specifying multiple comparators
in the <code>mu_list</code> and <code>sigma_list</code> parameters. The
<a href="../reference/sampleSize.html">sampleSize()</a> function can
accommodate multiple treatments, allowing for the evaluation of
equivalence across different products or formulations.</p>
<p>Although trials with multiple arms are common, there is no clear
consensus in the literature as to whether statistical corrections should
be applied for testing multiple primary hypotheses in such analyses. In
SimTOST, no adjustments are made for trials involving more than two
treatment arms.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-chowdhry_finding_2024" class="csl-entry">
Chowdhry, Amit K., John Park, John Kang, Gukan Sakthivel, and Stephanie
Pugh. 2024. <span>“Finding <span>Multiple Signals</span> in the
<span>Noise</span>: <span>Handling Multiplicity</span> in <span>Clinical
Trials</span>.”</span> <em>International Journal of Radiation
Oncology*Biology*Physics</em> 119 (3): 750–55. <a href="https://doi.org/10.1016/j.ijrobp.2023.12.007" class="external-link">https://doi.org/10.1016/j.ijrobp.2023.12.007</a>.
</div>
<div id="ref-CHMP2010" class="csl-entry">
Committee for Medicinal Products for Human Use (CHMP). 2010.
<span>“Guideline on the Investigation of Bioequivalence.”</span>
CPMP/EWP/QWP/1401/98. London, UK: European Medicines Agency. <a href="https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf" class="external-link">https://www.ema.europa.eu/en/documents/scientific-guideline/guideline-investigation-bioequivalence-rev1_en.pdf</a>.
</div>
<div id="ref-cpmp_points_2002" class="csl-entry">
Committee for Propietary Medicinal Products (CPMP). 2002. <span>“Points
to Consider on Multiplicity Issues in Clinical Trials.”</span>
Scientific Guideline CPMP/EWP/908/99. London, UK: The European Agency
for the Evaluation of Medicinal Products.
</div>
<div id="ref-mielke_sample_2018" class="csl-entry">
Mielke, Johanna, Byron Jones, Bernd Jilma, and Franz König. 2018.
<span>“Sample <span>Size</span> for <span>Multiple Hypothesis
Testing</span> in <span>Biosimilar Development</span>.”</span>
<em>Statistics in Biopharmaceutical Research</em> 10 (1): 39–49. <a href="https://doi.org/10.1080/19466315.2017.1371071" class="external-link">https://doi.org/10.1080/19466315.2017.1371071</a>.
</div>
<div id="ref-sozu_continuous_2015" class="csl-entry">
Sozu, Takashi, Tomoyuki Sugimoto, Toshimitsu Hamasaki, and Scott R.
Evans. 2015a. <span>“Continuous Primary Endpoints.”</span> In <em>Sample
Size Determination in Clinical Trials with Multiple Endpoints</em>,
59–68. Cham: Springer International Publishing. <a href="https://doi.org/10.1007/978-3-319-22005-5_5" class="external-link">https://doi.org/10.1007/978-3-319-22005-5_5</a>.
</div>
<div id="ref-sozu_sample_2015" class="csl-entry">
———. 2015b. <em>Sample <span>Size Determination</span> in <span>Clinical
Trials</span> with <span>Multiple Endpoints</span></em>.
<span>SpringerBriefs</span> in <span>Statistics</span>. Cham: Springer
International Publishing. <a href="https://doi.org/10.1007/978-3-319-22005-5" class="external-link">https://doi.org/10.1007/978-3-319-22005-5</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Thomas Debray, Johanna Munoz, Biogen Inc.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
